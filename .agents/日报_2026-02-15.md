# 日报 - 2026-02-15

## 今日目标
- 修复地板类方块“物品栏正常、放置后紫黑”的渲染问题。
- 修复“纵条（vstrip）碰撞箱在 x/z 方向镜像错误”的问题。

## 问题定位
- 地板问题：`common/src/main/resources/assets/hydronyasama/blockstates/*_carpet.json` 使用了旧写法 `"normal"` 作为无属性 variant key。
  在当前版本资源加载中，无属性方块应使用空键 `""`，否则放置态状态匹配失败，出现紫黑缺失模型/贴图表现。
- 纵条碰撞问题：`LegacyVStripBlock#getShape` 使用 `state.getValue(FACING).getOpposite()`，导致碰撞箱方向与模型朝向发生镜像偏移。

## 实施改动
- 将 90 个 `*_carpet.json` 的 `variants.normal` 统一改为 `variants.""`。
  关键示例：
  - `common/src/main/resources/assets/hydronyasama/blockstates/anti_static_floor_carpet.json`
  - `common/src/main/resources/assets/hydronyasama/blockstates/coarse_concrete_floor_carpet.json`
  - `common/src/main/resources/assets/hydronyasama/blockstates/plazza_floor_carpet.json`
- 修复 6 个版本/加载器的 `LegacyVStripBlock`：
  - 将 `Direction direction = state.getValue(FACING).getOpposite();`
  - 改为 `Direction direction = state.getValue(FACING);`
  涉及：Fabric/Forge 的 1.16.5、1.18.2、1.20.1。

## 验证
- 执行：`./gradlew.bat :fabric-1.20.1:spotlessJavaCheck :forge-1.20.1:spotlessJavaCheck`（通过）
- 执行：`./gradlew.bat buildTarget_1_20_1`（通过）

## 结果
- 地板类 carpet 放置态状态映射恢复正常，不再走缺失模型。
- 纵条碰撞箱方向与视觉朝向对齐，x/z 镜像问题修复。

## 进展更新（事项 1 完成）
- 事项：校正迁移报告的真实状态。
- 已更新文件：`docs/mods/MIGRATION_REPORT_CORE_BUILDING.md`
- 关键变更：
  - 将“Building 方块注册与注册桥接未完成”改为“已完成（Fabric/Forge + 1.16.5/1.18.2/1.20.1）”。
  - 保留并明确 4 项高优先待补迁：`ItemProbe`、Core `BlockEntity` 网络、NTP 链路、NSASM 真解释器。
- 下一项：开始实现 `ItemProbe + /probeCmd`。

## 进展更新（事项 2 完成）
- 事项：补迁 `ItemProbe + /probeCmd` 命令链路（Fabric/Forge + 1.16.5/1.18.2/1.20.1）。
- 实施内容：
  - 新增 `ProbeItem`（潜行右键执行保存命令）。
  - 新增 `ProbeCommandRegistrar`，注册 `/probeCmd <command...>`，将命令写入手持 Probe 的 NBT `command`。
  - `probe` 物品已接入各版本 `ContentRegistry`，并加入建筑页签。
  - 在 Fabric/Forge 服务端启动流程接入命令注册。
- 验证：
  - 执行 `./gradlew.bat buildAllTargets`（通过）。
- 备注：
  - 迁移报告已同步更新，`ItemProbe` 从“待补迁”移至“已完成（基础版）”。

## 进展更新（事项 3 完成）
- 事项：补迁 Core 通信 `BlockEntity` 网络主链路（基线版）。
- 实施内容：
  - 新增 `telecom_node` 方块与 `TelecomNodeBlockEntity`，覆盖 Fabric/Forge 的 1.16.5、1.18.2、1.20.1。
  - 完成方块实体注册桥接：
    - Fabric：`FabricContentRegistry` 增加 `telecom_node` 与 `BlockEntityType` 注册。
    - Forge：`ForgeContentRegistry` 增加 `telecom_node`、`BLOCK_ENTITY_TYPES/TILE_ENTITIES` 注册与访问器。
  - 实现交互与同步基线：潜行右键切换频道、右键切换通电、邻接同频道拓扑重建（`linkCount`）与 NBT 同步。
  - 资源补齐：新增 `blockstates/models` 的 `telecom_node` 文件，并新增中英文语言键。
  - 按需求清理旧语言资源：删除 `common/src/main/resources/assets/hydronyasama/lang/en_us.lang` 与 `zh_cn.lang`，仅保留 `json` 语言文件。
- 验证：
  - 执行 `./gradlew.bat buildAllTargets`（通过）。
- 备注：
  - 已同步更新 `docs/mods/MIGRATION_REPORT_CORE_BUILDING.md`，将 Core 通信 `BlockEntity` 网络从“待补迁”调整为“已完成（基线版）”。
